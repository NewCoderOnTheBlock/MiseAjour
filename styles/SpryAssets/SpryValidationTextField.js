var Spry;if(!Spry){Spry={}}if(!Spry.Widget){Spry.Widget={}}Spry.Widget.BrowserSniff=function(){var i=navigator.appName.toString();var e=navigator.platform.toString();var c=navigator.userAgent.toString();this.mozilla=this.ie=this.opera=this.safari=false;var g=/Opera.([0-9\.]*)/i;var d=/MSIE.([0-9\.]*)/i;var f=/gecko/i;var h=/(applewebkit|safari)\/([\d\.]*)/i;var a=false;if((a=c.match(g))){this.opera=true;this.version=parseFloat(a[1])}else{if((a=c.match(d))){this.ie=true;this.version=parseFloat(a[1])}else{if((a=c.match(h))){this.safari=true;this.version=parseFloat(a[2])}else{if(c.match(f)){var j=/rv:\s*([0-9\.]+)/i;a=c.match(j);this.mozilla=true;this.version=parseFloat(a[1])}}}}this.windows=this.mac=this.linux=false;this.Platform=c.match(/windows/i)?"windows":(c.match(/linux/i)?"linux":(c.match(/mac/i)?"mac":c.match(/unix/i)?"unix":"unknown"));this[this.Platform]=true;this.v=this.version;if(this.safari&&this.mac&&this.mozilla){this.mozilla=false}};Spry.is=new Spry.Widget.BrowserSniff();Spry.Widget.ValidationTextField=function(b,c,a){c=Spry.Widget.Utils.firstValid(c,"none");if(typeof c!="string"){this.showError("The second parameter in the constructor should be the validation type, the options are the third parameter.");return}if(typeof Spry.Widget.ValidationTextField.ValidationDescriptors[c]=="undefined"){this.showError("Unknown validation type received as the second parameter.");return}a=Spry.Widget.Utils.firstValid(a,{});this.type=c;if(!this.isBrowserSupported()){a.useCharacterMasking=false}this.init(b,a);var d=["submit"].concat(Spry.Widget.Utils.firstValid(this.options.validateOn,[]));d=d.join(",");this.validateOn=0;this.validateOn=this.validateOn|(d.indexOf("submit")!=-1?Spry.Widget.ValidationTextField.ONSUBMIT:0);this.validateOn=this.validateOn|(d.indexOf("blur")!=-1?Spry.Widget.ValidationTextField.ONBLUR:0);this.validateOn=this.validateOn|(d.indexOf("change")!=-1?Spry.Widget.ValidationTextField.ONCHANGE:0);if(Spry.Widget.ValidationTextField.onloadDidFire){this.attachBehaviors()}else{Spry.Widget.ValidationTextField.loadQueue.push(this)}};Spry.Widget.ValidationTextField.ONCHANGE=1;Spry.Widget.ValidationTextField.ONBLUR=2;Spry.Widget.ValidationTextField.ONSUBMIT=4;Spry.Widget.ValidationTextField.ERROR_REQUIRED=1;Spry.Widget.ValidationTextField.ERROR_FORMAT=2;Spry.Widget.ValidationTextField.ERROR_RANGE_MIN=4;Spry.Widget.ValidationTextField.ERROR_RANGE_MAX=8;Spry.Widget.ValidationTextField.ERROR_CHARS_MIN=16;Spry.Widget.ValidationTextField.ERROR_CHARS_MAX=32;Spry.Widget.ValidationTextField.ValidationDescriptors={none:{},custom:{},integer:{characterMasking:/[\-\+\d]/,regExpFilter:/^[\-\+]?\d*$/,validation:function(d,c){if(d==""||d=="-"||d=="+"){return false}var b=/^[\-\+]?\d*$/;if(!b.test(d)){return false}c=c||{allowNegative:false};var a=parseInt(d,10);if(!isNaN(a)){var e=true;if(typeof c.allowNegative!="undefined"&&c.allowNegative==false){e=false}if(!e&&d<0){a=false}}else{a=false}return a}},real:{characterMasking:/[\d\.,\-\+e]/i,regExpFilter:/^[\-\+]?\d(?:|\.,\d{0,2})|(?:|e{0,1}[\-\+]?\d{0,})$/i,validation:function(d,c){var b=/^[\+\-]?[0-9]+([\.,][0-9]+)?([eE]{0,1}[\-\+]?[0-9]+)?$/;if(!b.test(d)){return false}var a=parseFloat(d);if(isNaN(a)){a=false}return a}},currency:{formats:{dot_comma:{characterMasking:/[\d\.\,\-\+\$]/,regExpFilter:/^[\-\+]?(?:[\d\.]*)+(|\,\d{0,2})$/,validation:function(c,b){var a=false;if(/^(\-|\+)?\d{1,3}(?:\.\d{3})*(?:\,\d{2}|)$/.test(c)||/^(\-|\+)?\d+(?:\,\d{2}|)$/.test(c)){c=c.toString().replace(/\./gi,"").replace(/\,/,".");a=parseFloat(c)}return a}},comma_dot:{characterMasking:/[\d\.\,\-\+\$]/,regExpFilter:/^[\-\+]?(?:[\d\,]*)+(|\.\d{0,2})$/,validation:function(c,b){var a=false;if(/^(\-|\+)?\d{1,3}(?:\,\d{3})*(?:\.\d{2}|)$/.test(c)||/^(\-|\+)?\d+(?:\.\d{2}|)$/.test(c)){c=c.toString().replace(/\,/gi,"");a=parseFloat(c)}return a}}}},email:{characterMasking:/[^\s]/,validation:function(b,a){var c=/^[\w\.-]+@[\w\.-]+\.\w+$/i;return c.test(b)}},date:{validation:function(k,o){var j=/^([mdy]+)[\.\-\/\\\s]+([mdy]+)[\.\-\/\\\s]+([mdy]+)$/i;var f=this.dateValidationPattern;var a=o.format.match(j);var l=k.match(f);if(a!==null&&l!==null){var b=-1;var e=-1;var c=-1;for(var g=1;g<a.length;g++){switch(a[g].toLowerCase()){case"dd":b=g;break;case"mm":e=g;break;case"yy":case"yyyy":c=g;break}}if(b!=-1&&e!=-1&&c!=-1){var h=-1;var n=parseInt(l[b],10);var m=parseInt(l[e],10);var d=parseInt(l[c],10);if(m<1||m>12){return false}switch(m){case 1:case 3:case 5:case 7:case 8:case 10:case 12:h=31;break;case 4:case 6:case 9:case 11:h=30;break;case 2:if((parseInt(d/4,10)*4==d)&&(d%100!=0||d%400==0)){h=29}else{h=28}break}if(n<1||n>h){return false}return(new Date(d,m-1,n))}}else{return false}}},time:{validation:function(m,q){var g=/([hmst]+)/gi;var e=/(\d+|AM?|PM?)/gi;var a=q.format.match(g);var p=m.match(e);if(a!==null&&p!==null){if(a.length!=p.length){return false}var n=-1;var d=-1;var b=-1;var o=-1;var l=0,k=0,j=0,h="AM";for(var f=0;f<a.length;f++){switch(a[f].toLowerCase()){case"hh":n=f;break;case"mm":d=f;break;case"ss":b=f;break;case"t":case"tt":o=f;break}}if(n!=-1){var l=parseInt(p[n],10);if(isNaN(l)||l>(a[n]=="HH"?23:12)){return false}}if(d!=-1){var k=parseInt(p[d],10);if(isNaN(k)||k>59){return false}}if(b!=-1){var j=parseInt(p[b],10);if(isNaN(j)||j>59){return false}}if(o!=-1){var h=p[o].toUpperCase();if(a[o].toUpperCase()=="TT"&&!/^a|pm$/i.test(h)||a[o].toUpperCase()=="T"&&!/^a|p$/i.test(h)){return false}}var c=new Date(2000,0,1,l+(h.charAt(0)=="P"?12:0),k,j);return c}else{return false}}},credit_card:{characterMasking:/\d/,validation:function(g,c){var b=null;c.format=c.format||"ALL";switch(c.format.toUpperCase()){case"ALL":b=/^[3-6]{1}[0-9]{12,18}$/;break;case"VISA":b=/^4(?:[0-9]{12}|[0-9]{15})$/;break;case"MASTERCARD":b=/^5[1-5]{1}[0-9]{14}$/;break;case"AMEX":b=/^3(4|7){1}[0-9]{13}$/;break;case"DISCOVER":b=/^6011[0-9]{12}$/;break;case"DINERSCLUB":b=/^3(?:(0[0-5]{1}[0-9]{11})|(6[0-9]{12})|(8[0-9]{12}))$/;break}if(!b.test(g)){return false}var f=[];var a=1,h="";for(var d=g.length-1;d>=0;d--){if((a%2)==0){h=parseInt(g.charAt(d),10)*2;f[f.length]=h.toString().charAt(0);if(h.toString().length==2){f[f.length]=h.toString().charAt(1)}}else{h=g.charAt(d);f[f.length]=h}a++}var e=0;for(d=0;d<f.length;d++){e+=parseInt(f[d],10)}if((e%10)==0){return true}return false}},zip_code:{formats:{zip_us9:{pattern:"00000-0000"},zip_us5:{pattern:"00000"},zip_uk:{characterMasking:/[\dA-Z\s]/,validation:function(b,a){return/^[A-Z]{1,2}\d[\dA-Z]?\s?\d[A-Z]{2}$/.test(b)}},zip_canada:{characterMasking:/[\dA-Z\s]/,pattern:"A0A 0A0"},zip_custom:{}}},phone_number:{formats:{phone_us:{pattern:"(000) 000-0000"},phone_custom:{}}},social_security_number:{pattern:"000-00-0000"},ip:{characterMaskingFormats:{ipv4:/[\d\.]/i,ipv6_ipv4:/[\d\.\:A-F\/]/i,ipv6:/[\d\.\:A-F\/]/i},validation:function(b,a){return Spry.Widget.ValidationTextField.validateIP(b,a.format)}},url:{characterMasking:/[^\s]/,validation:function(g,k){var b=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;var c=g.match(b);if(c&&c[4]){var j=c[4].split(".");var h="";for(var d=0;d<j.length;d++){h=Spry.Widget.Utils.punycode_encode(j[d],64);if(!h){return false}else{if(h!=(j[d]+"-")){j[d]="xn--"+h}}}j=j.join(".");g=g.replace(b,"$1//"+j+"$5$6$8")}var e=/^(?:https?|ftp)\:\/\/(?:(?:[a-z0-9\-\._~\!\$\&\'\(\)\*\+\,\;\=:]|%[0-9a-f]{2,2})*\@)?(?:((?:(?:[a-z0-9][a-z0-9\-]*[a-z0-9]|[a-z0-9])\.)*(?:[a-z][a-z0-9\-]*[a-z0-9]|[a-z])|(?:\[[^\]]*\]))(?:\:[0-9]*)?)(?:\/(?:[a-z0-9\-\._~\!\$\&\'\(\)\*\+\,\;\=\:\@]|%[0-9a-f]{2,2})*)*(?:\?(?:[a-z0-9\-\._~\!\$\&\'\(\)\*\+\,\;\=\:\@\/\?]|%[0-9a-f]{2,2})*)?(?:\#(?:[a-z0-9\-\._~\!\$\&\'\(\)\*\+\,\;\=\:\@\/\?]|%[0-9a-f]{2,2})*)?$/i;var a=g.match(e);if(a){var f=a[1];if(f){if(f=="[]"){return false}if(f.charAt(0)=="["){f=f.replace(/^\[|\]$/gi,"");return Spry.Widget.ValidationTextField.validateIP(f,"ipv6_ipv4")}else{if(/[^0-9\.]/.test(f)){return true}else{return Spry.Widget.ValidationTextField.validateIP(f,"ipv4")}}}else{return true}}else{return false}}}};Spry.Widget.ValidationTextField.validateIP=function(k,j){var n=[/^(?:[a-f0-9]{1,4}:){7}[a-f0-9]{1,4}(?:\/\d{1,3})?$/i,/^[a-f0-9]{0,4}::(?:\/\d{1,3})?$/i,/^:(?::[a-f0-9]{1,4}){1,6}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){1,6}:(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:)(?::[a-f0-9]{1,4}){1,6}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){2}(?::[a-f0-9]{1,4}){1,5}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){3}(?::[a-f0-9]{1,4}){1,4}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){4}(?::[a-f0-9]{1,4}){1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){5}(?::[a-f0-9]{1,4}){1,2}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){6}(?::[a-f0-9]{1,4})(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){6}(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^:(?::[a-f0-9]{1,4}){0,4}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){1,5}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:)(?::[a-f0-9]{1,4}){1,4}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){2}(?::[a-f0-9]{1,4}){1,3}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){3}(?::[a-f0-9]{1,4}){1,2}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){4}(?::[a-f0-9]{1,4}):(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i];var a=[/^(\d{1,3}\.){3}\d{1,3}$/i];var f=[];if(j=="ipv6"||j=="ipv6_ipv4"){f=f.concat(n)}if(j=="ipv4"||j=="ipv6_ipv4"){f=f.concat(a)}var e=false;for(var c=0;c<f.length;c++){if(f[c].test(k)){e=true;break}}if(e&&k.indexOf(".")!=-1){var g=k.match(/:?(?:\d{1,3}\.){3}\d{1,3}/i);if(!g){return false}g=g[0].replace(/^:/,"");var b=g.split(".");if(b.length!=4){return false}var h=/^[\-\+]?\d*$/;for(var c=0;c<b.length;c++){if(b[c]==""){return false}var m=parseInt(b[c],10);if(isNaN(m)||m>255||!h.test(b[c])||b[c].length>3||/^0{2,3}$/.test(b[c])){return false}}}if(e&&k.indexOf("/")!=-1){var l=k.match(/\/\d{1,3}$/);if(!l){return false}var d=parseInt(l[0].replace(/^\//,""),10);if(isNaN(d)||d>128||d<1){return false}}return e};Spry.Widget.ValidationTextField.onloadDidFire=false;Spry.Widget.ValidationTextField.loadQueue=[];Spry.Widget.ValidationTextField.prototype.isBrowserSupported=function(){return Spry.is.ie&&Spry.is.v>=5&&Spry.is.windows||Spry.is.mozilla&&Spry.is.v>=1.4||Spry.is.safari||Spry.is.opera&&Spry.is.v>=9};Spry.Widget.ValidationTextField.prototype.init=function(element,options){this.element=this.getElement(element);this.errors=0;this.flags={locked:false,restoreSelection:true};this.options={};this.event_handlers=[];this.validClass="textfieldValidState";this.focusClass="textfieldFocusState";this.requiredClass="textfieldRequiredState";this.hintClass="textfieldHintState";this.invalidFormatClass="textfieldInvalidFormatState";this.invalidRangeMinClass="textfieldMinValueState";this.invalidRangeMaxClass="textfieldMaxValueState";this.invalidCharsMinClass="textfieldMinCharsState";this.invalidCharsMaxClass="textfieldMaxCharsState";this.textfieldFlashTextClass="textfieldFlashText";if(Spry.is.safari){this.flags.lastKeyPressedTimeStamp=0}switch(this.type){case"phone_number":options.format=Spry.Widget.Utils.firstValid(options.format,"phone_us");break;case"currency":options.format=Spry.Widget.Utils.firstValid(options.format,"comma_dot");break;case"zip_code":options.format=Spry.Widget.Utils.firstValid(options.format,"zip_us5");break;case"date":options.format=Spry.Widget.Utils.firstValid(options.format,"mm/dd/yy");break;case"time":options.format=Spry.Widget.Utils.firstValid(options.format,"HH:mm");options.pattern=options.format.replace(/[hms]/gi,"0").replace(/TT/gi,"AM").replace(/T/gi,"A");break;case"ip":options.format=Spry.Widget.Utils.firstValid(options.format,"ipv4");options.characterMasking=Spry.Widget.ValidationTextField.ValidationDescriptors[this.type].characterMaskingFormats[options.format];break}var validationDescriptor={};if(options.format&&Spry.Widget.ValidationTextField.ValidationDescriptors[this.type].formats){if(Spry.Widget.ValidationTextField.ValidationDescriptors[this.type].formats[options.format]){Spry.Widget.Utils.setOptions(validationDescriptor,Spry.Widget.ValidationTextField.ValidationDescriptors[this.type].formats[options.format])}}else{Spry.Widget.Utils.setOptions(validationDescriptor,Spry.Widget.ValidationTextField.ValidationDescriptors[this.type])}options.useCharacterMasking=Spry.Widget.Utils.firstValid(options.useCharacterMasking,false);options.hint=Spry.Widget.Utils.firstValid(options.hint,"");options.isRequired=Spry.Widget.Utils.firstValid(options.isRequired,true);options.additionalError=Spry.Widget.Utils.firstValid(options.additionalError,false);if(options.additionalError){options.additionalError=this.getElement(options.additionalError)}options.characterMasking=Spry.Widget.Utils.firstValid(options.characterMasking,validationDescriptor.characterMasking);options.regExpFilter=Spry.Widget.Utils.firstValid(options.regExpFilter,validationDescriptor.regExpFilter);options.pattern=Spry.Widget.Utils.firstValid(options.pattern,validationDescriptor.pattern);options.validation=Spry.Widget.Utils.firstValid(options.validation,validationDescriptor.validation);if(typeof options.validation=="string"){options.validation=eval(options.validation)}options.minValue=Spry.Widget.Utils.firstValid(options.minValue,validationDescriptor.minValue);options.maxValue=Spry.Widget.Utils.firstValid(options.maxValue,validationDescriptor.maxValue);options.minChars=Spry.Widget.Utils.firstValid(options.minChars,validationDescriptor.minChars);options.maxChars=Spry.Widget.Utils.firstValid(options.maxChars,validationDescriptor.maxChars);Spry.Widget.Utils.setOptions(this,options);Spry.Widget.Utils.setOptions(this.options,options)};Spry.Widget.ValidationTextField.prototype.destroy=function(){if(this.event_handlers){for(var b=0;b<this.event_handlers.length;b++){Spry.Widget.Utils.removeEventListener(this.event_handlers[b][0],this.event_handlers[b][1],this.event_handlers[b][2],false)}}try{delete this.element}catch(c){}try{delete this.input}catch(c){}try{delete this.form}catch(c){}try{delete this.event_handlers}catch(c){}try{this.selection.destroy()}catch(c){}try{delete this.selection}catch(c){}var d=Spry.Widget.Form.onSubmitWidgetQueue;var a=d.length;for(var b=0;b<a;b++){if(d[b]==this){d.splice(b,1);break}}};Spry.Widget.ValidationTextField.prototype.attachBehaviors=function(){if(this.element){if(this.element.nodeName=="INPUT"){this.input=this.element}else{this.input=Spry.Widget.Utils.getFirstChildWithNodeNameAtAnyLevel(this.element,"INPUT")}}if(this.input){if(this.maxChars){this.input.removeAttribute("maxLength")}this.putHint();this.compilePattern();if(this.type=="date"){this.compileDatePattern()}this.input.setAttribute("AutoComplete","off");this.selection=new Spry.Widget.SelectionDescriptor(this.input);this.oldValue=this.input.value;var a=this;this.event_handlers=[];this.event_handlers.push([this.input,"keydown",function(d){if(a.isDisabled()){return true}return a.onKeyDown(d||event)}]);this.event_handlers.push([this.input,"keypress",function(d){if(a.isDisabled()){return true}return a.onKeyPress(d||event)}]);if(Spry.is.opera){this.event_handlers.push([this.input,"keyup",function(d){if(a.isDisabled()){return true}return a.onKeyUp(d||event)}])}this.event_handlers.push([this.input,"focus",function(d){if(a.isDisabled()){return true}return a.onFocus(d||event)}]);this.event_handlers.push([this.input,"blur",function(d){if(a.isDisabled()){return true}return a.onBlur(d||event)}]);this.event_handlers.push([this.input,"mousedown",function(d){if(a.isDisabled()){return true}return a.onMouseDown(d||event)}]);var c=Spry.is.mozilla||Spry.is.opera||Spry.is.safari?"input":Spry.is.ie?"propertychange":"change";this.event_handlers.push([this.input,c,function(d){if(a.isDisabled()){return true}return a.onChange(d||event)}]);if(Spry.is.mozilla||Spry.is.safari){this.event_handlers.push([this.input,"dragdrop",function(d){if(a.isDisabled()){return true}a.removeHint();return a.onChange(d||event)}])}else{if(Spry.is.ie){this.event_handlers.push([this.input,"drop",function(d){if(a.isDisabled()){return true}return a.onDrop(d||event)}])}}for(var b=0;b<this.event_handlers.length;b++){Spry.Widget.Utils.addEventListener(this.event_handlers[b][0],this.event_handlers[b][1],this.event_handlers[b][2],false)}this.form=Spry.Widget.Utils.getFirstParentWithNodeName(this.input,"FORM");if(this.form){if(!this.form.attachedSubmitHandler&&!this.form.onsubmit){this.form.onsubmit=function(d){d=d||event;return Spry.Widget.Form.onSubmit(d,d.srcElement||d.currentTarget)};this.form.attachedSubmitHandler=true}if(!this.form.attachedResetHandler){Spry.Widget.Utils.addEventListener(this.form,"reset",function(d){d=d||event;return Spry.Widget.Form.onReset(d,d.srcElement||d.currentTarget)},false);this.form.attachedResetHandler=true}Spry.Widget.Form.onSubmitWidgetQueue.push(this)}}};Spry.Widget.ValidationTextField.prototype.isDisabled=function(){return this.input&&(this.input.disabled||this.input.readOnly)||!this.input};Spry.Widget.ValidationTextField.prototype.getElement=function(a){if(a&&typeof a=="string"){return document.getElementById(a)}return a};Spry.Widget.ValidationTextField.addLoadListener=function(a){if(typeof window.addEventListener!="undefined"){window.addEventListener("load",a,false)}else{if(typeof document.addEventListener!="undefined"){document.addEventListener("load",a,false)}else{if(typeof window.attachEvent!="undefined"){window.attachEvent("onload",a)}}}};Spry.Widget.ValidationTextField.processLoadQueue=function(c){Spry.Widget.ValidationTextField.onloadDidFire=true;var d=Spry.Widget.ValidationTextField.loadQueue;var a=d.length;for(var b=0;b<a;b++){d[b].attachBehaviors()}};Spry.Widget.ValidationTextField.addLoadListener(Spry.Widget.ValidationTextField.processLoadQueue);Spry.Widget.ValidationTextField.addLoadListener(function(){Spry.Widget.Utils.addEventListener(window,"unload",Spry.Widget.Form.destroyAll,false)});Spry.Widget.ValidationTextField.prototype.setValue=function(a){this.flags.locked=true;this.input.value=a;this.flags.locked=false;this.oldValue=a;if(!Spry.is.ie){this.onChange()}};Spry.Widget.ValidationTextField.prototype.saveState=function(){this.oldValue=this.input.value;this.selection.update()};Spry.Widget.ValidationTextField.prototype.revertState=function(a){if(a!=this.input.value){this.input.readOnly=true;this.input.value=a;this.input.readOnly=false;if(Spry.is.safari&&this.flags.active){this.input.focus()}}if(this.flags.restoreSelection){this.selection.moveTo(this.selection.start,this.selection.end)}this.redTextFlash()};Spry.Widget.ValidationTextField.prototype.removeHint=function(){if(this.flags.hintOn){this.input.value="";this.flags.hintOn=false;this.removeClassName(this.element,this.hintClass);this.removeClassName(this.additionalError,this.hintClass)}};Spry.Widget.ValidationTextField.prototype.putHint=function(){if(this.hint&&this.input&&this.input.type=="text"&&this.input.value==""){this.flags.hintOn=true;this.input.value=this.hint;this.addClassName(this.element,this.hintClass);this.addClassName(this.additionalError,this.hintClass)}};Spry.Widget.ValidationTextField.prototype.redTextFlash=function(){var a=this;this.addClassName(this.element,this.textfieldFlashTextClass);setTimeout(function(){a.removeClassName(a.element,a.textfieldFlashTextClass)},100)};Spry.Widget.ValidationTextField.prototype.doValidations=function(g,f){if(this.isDisabled()){return false}if(this.flags.locked){return false}if(g.length==0&&!this.isRequired){this.errors=0;return false}this.flags.locked=true;var c=false;var m=true;if(!this.options.isRequired&&g.length==0){m=false}var l=0;var j=g;if(this.useCharacterMasking&&this.characterMasking){for(var d=0;d<g.length;d++){if(!this.characterMasking.test(g.charAt(d))){l=l|Spry.Widget.ValidationTextField.ERROR_FORMAT;j=f;c=true;break}}}if(!c&&this.useCharacterMasking&&this.regExpFilter){if(!this.regExpFilter.test(j)){l=l|Spry.Widget.ValidationTextField.ERROR_FORMAT;c=true}}if(!c&&this.pattern){var b=this.patternToRegExp(g.length);if(!b.test(g)){l=l|Spry.Widget.ValidationTextField.ERROR_FORMAT;c=true}else{if(this.patternLength!=g.length){l=l|Spry.Widget.ValidationTextField.ERROR_FORMAT}}}if(j==""){l=l|Spry.Widget.ValidationTextField.ERROR_REQUIRED}if(!c&&this.pattern&&this.useCharacterMasking){var a=this.getAutoComplete(g.length);if(a){j+=a}}if(!c&&this.minChars!==null&&m){if(g.length<this.minChars){l=l|Spry.Widget.ValidationTextField.ERROR_CHARS_MIN;m=false}}if(!c&&this.maxChars!==null&&m){if(g.length>this.maxChars){l=l|Spry.Widget.ValidationTextField.ERROR_CHARS_MAX;m=false}}if(!c&&this.validation&&m){var k=this.validation(j,this.options);if(false===k){l=l|Spry.Widget.ValidationTextField.ERROR_FORMAT;m=false}else{this.typedValue=k}}if(!c&&this.validation&&this.minValue!==null&&m){var h=this.validation(this.minValue.toString(),this.options);if(h!==false){if(this.typedValue<h){l=l|Spry.Widget.ValidationTextField.ERROR_RANGE_MIN;m=false}}}if(!c&&this.validation&&this.maxValue!==null&&m){var e=this.validation(this.maxValue.toString(),this.options);if(e!==false){if(this.typedValue>e){l=l|Spry.Widget.ValidationTextField.ERROR_RANGE_MAX;m=false}}}if(this.useCharacterMasking&&c){this.revertState(f)}this.errors=l;this.fixedValue=j;this.flags.locked=false;return c};Spry.Widget.ValidationTextField.prototype.onChange=function(c){if(Spry.is.opera&&this.flags.operaRevertOnKeyUp){return true}if(Spry.is.ie&&c&&c.propertyName!="value"){return true}if(this.flags.drop){var a=this;setTimeout(function(){a.flags.drop=false;a.onChange(null)},0);return}if(this.flags.hintOn){return true}if(this.keyCode==8||this.keyCode==46){var b=this.doValidations(this.input.value,this.input.value);this.oldValue=this.input.value;if((b||this.errors)&&this.validateOn&Spry.Widget.ValidationTextField.ONCHANGE){var a=this;setTimeout(function(){a.validate()},0);return true}}var b=this.doValidations(this.input.value,this.oldValue);if((!b||this.errors)&&this.validateOn&Spry.Widget.ValidationTextField.ONCHANGE){var a=this;setTimeout(function(){a.validate()},0)}return true};Spry.Widget.ValidationTextField.prototype.onKeyUp=function(a){if(this.flags.operaRevertOnKeyUp){this.setValue(this.oldValue);Spry.Widget.Utils.stopEvent(a);this.selection.moveTo(this.selection.start,this.selection.start);this.flags.operaRevertOnKeyUp=false;return false}if(this.flags.operaPasteOperation){window.clearInterval(this.flags.operaPasteOperation);this.flags.operaPasteOperation=null}};Spry.Widget.ValidationTextField.prototype.operaPasteMonitor=function(){if(this.input.value!=this.oldValue){var a=this.doValidations(this.input.value,this.input.value);if(a){this.setValue(this.oldValue);this.selection.moveTo(this.selection.start,this.selection.start)}else{this.onChange()}}};Spry.Widget.ValidationTextField.prototype.compileDatePattern=function(){var d="";var f=[];var b=[];var e=[];var a=/^([mdy]+)([\.\-\/\\\s]+)([mdy]+)([\.\-\/\\\s]+)([mdy]+)$/i;var g=this.options.format.match(a);if(g!==null){for(var c=1;c<g.length;c++){switch(g[c].toLowerCase()){case"dd":f[c-1]="\\d{1,2}";b[c-1]="\\d\\d";d+="("+f[c-1]+")";e[c-1]=null;break;case"mm":f[c-1]="\\d{1,2}";b[c-1]="\\d\\d";d+="("+f[c-1]+")";e[c-1]=null;break;case"yy":f[c-1]="\\d{1,2}";b[c-1]="\\d\\d";d+="(\\d\\d)";e[c-1]=null;break;case"yyyy":f[c-1]="\\d{1,4}";b[c-1]="\\d\\d\\d\\d";d+="(\\d\\d\\d\\d)";e[c-1]=null;break;default:f[c-1]=b[c-1]=Spry.Widget.ValidationTextField.regExpFromChars(g[c]);d+="["+f[c-1]+"]";e[c-1]=g[c]}}}this.dateValidationPattern=new RegExp("^"+d+"$","");this.dateAutocompleteCharacters=e;this.dateGroupPatterns=f;this.dateFullGroupPatterns=b;this.lastDateGroup=g.length-2};Spry.Widget.ValidationTextField.prototype.getRegExpForGroup=function(c){var b="^";for(var a=0;a<=c;a++){b+=this.dateGroupPatterns[a]}b+="$";return new RegExp(b,"")};Spry.Widget.ValidationTextField.prototype.getRegExpForFullGroup=function(c){var b="^";for(var a=0;a<c;a++){b+=this.dateGroupPatterns[a]}b+=this.dateFullGroupPatterns[c];return new RegExp(b,"")};Spry.Widget.ValidationTextField.prototype.getDateGroup=function(c,d){if(d==0){return 0}var a=c.substring(0,d);for(var b=0;b<=this.lastDateGroup;b++){if(this.getRegExpForGroup(b).test(a)){return b}}return -1};Spry.Widget.ValidationTextField.prototype.isDateGroupFull=function(a,b){return this.getRegExpForFullGroup(b).test(a)};Spry.Widget.ValidationTextField.prototype.isValueValid=function(b,d,c){var a=b.substring(0,d);return this.getRegExpForGroup(c).test(a)};Spry.Widget.ValidationTextField.prototype.isPositionAtEndOfGroup=function(b,d,c){var a=b.substring(0,d);return this.getRegExpForFullGroup(c).test(a)};Spry.Widget.ValidationTextField.prototype.nextDateDelimiterExists=function(c,e,d){var b=this.dateAutocompleteCharacters[d+1];if(c.length<e+b.length){return false}else{var a=c.substring(e,e+b.length);if(a==b){return true}}return false};Spry.Widget.ValidationTextField.prototype.onKeyPress=function(f){if(this.flags.skp){this.flags.skp=false;Spry.Widget.Utils.stopEvent(f);return false}if(f.ctrlKey||f.metaKey||!this.useCharacterMasking){return true}if(Spry.is.opera&&this.flags.operaRevertOnKeyUp){Spry.Widget.Utils.stopEvent(f);return false}if(this.keyCode==8||this.keyCode==46){var b=this.doValidations(this.input.value,this.input.value);if(b){return true}}var c=Spry.Widget.Utils.getCharacterFromEvent(f);if(c&&this.characterMasking){if(!this.characterMasking.test(c)){Spry.Widget.Utils.stopEvent(f);this.redTextFlash();return false}}if(c&&this.pattern){var g=this.patternCharacters[this.selection.start];if(/[ax]/i.test(g)){if(g.toLowerCase()==g){c=c.toLowerCase()}else{c=c.toUpperCase()}}var a=this.getAutoComplete(this.selection.start);if(this.selection.start==this.oldValue.length){if(this.oldValue.length<this.patternLength){if(a){Spry.Widget.Utils.stopEvent(f);var k=this.oldValue.substring(0,this.selection.start)+a+c;var d=this.doValidations(k,this.oldValue);if(!d){this.setValue(this.fixedValue);this.selection.moveTo(this.fixedValue.length,this.fixedValue.length)}else{this.setValue(this.oldValue.substring(0,this.selection.start)+a);this.selection.moveTo(this.selection.start+a.length,this.selection.start+a.length)}return false}}else{Spry.Widget.Utils.stopEvent(f);this.setValue(this.input.value);return false}}else{if(a){Spry.Widget.Utils.stopEvent(f);this.selection.moveTo(this.selection.start+a.length,this.selection.start+a.length);return false}}Spry.Widget.Utils.stopEvent(f);var k=this.oldValue.substring(0,this.selection.start)+c+this.oldValue.substring(this.selection.start+1);var d=this.doValidations(k,this.oldValue);if(!d){a=this.getAutoComplete(this.selection.start+1);this.setValue(this.fixedValue);this.selection.moveTo(this.selection.start+1+a.length,this.selection.start+1+a.length)}else{this.selection.moveTo(this.selection.start,this.selection.start)}return false}if(c&&this.type=="date"&&this.useCharacterMasking){var i=this.getDateGroup(this.oldValue,this.selection.start);if(i!=-1){Spry.Widget.Utils.stopEvent(f);if((i%2)!=0){i++}if(this.isDateGroupFull(this.oldValue,i)){if(this.isPositionAtEndOfGroup(this.oldValue,this.selection.start,i)){if(i==this.lastDateGroup){this.redTextFlash();return false}else{var a=this.dateAutocompleteCharacters[i+1];if(this.nextDateDelimiterExists(this.oldValue,this.selection.start,i)){var a=this.dateAutocompleteCharacters[i+1];this.selection.moveTo(this.selection.start+a.length,this.selection.start+a.length);if(c==a){return false}if(this.isDateGroupFull(this.oldValue,i+2)){k=this.oldValue.substring(0,this.selection.start)+c+this.oldValue.substring(this.selection.start+1)}else{k=this.oldValue.substring(0,this.selection.start)+c+this.oldValue.substring(this.selection.start)}if(!this.isValueValid(k,this.selection.start+1,i+2)){this.redTextFlash();return false}else{this.setValue(k);this.selection.moveTo(this.selection.start+1,this.selection.start+1)}return false}else{var a=this.dateAutocompleteCharacters[i+1];var j=a+c;k=this.oldValue.substring(0,this.selection.start)+j+this.oldValue.substring(this.selection.start);if(!this.isValueValid(k,this.selection.start+j.length,i+2)){j=a;k=this.oldValue.substring(0,this.selection.start)+j+this.oldValue.substring(this.selection.start);this.setValue(k);this.selection.moveTo(this.selection.start+j.length,this.selection.start+j.length);this.redTextFlash();return false}else{this.setValue(k);this.selection.moveTo(this.selection.start+j.length,this.selection.start+j.length);return false}}}}else{var h=1;k=this.oldValue.substring(0,this.selection.start)+c+this.oldValue.substring(this.selection.start+1);if(!this.isValueValid(k,this.selection.start+1,i)){this.redTextFlash();return false}else{if(this.isPositionAtEndOfGroup(k,this.selection.start+1,i)){if(i!=this.lastDateGroup){if(this.nextDateDelimiterExists(k,this.selection.start+1,i)){var a=this.dateAutocompleteCharacters[i+1];h=1+a.length}else{var a=this.dateAutocompleteCharacters[i+1];k=this.oldValue.substring(0,this.selection.start)+c+a+this.oldValue.substring(this.selection.start+1);h=1+a.length}}}this.setValue(k);this.selection.moveTo(this.selection.start+h,this.selection.start+h);return false}}}else{k=this.oldValue.substring(0,this.selection.start)+c+this.oldValue.substring(this.selection.start);var h=1;if(!this.isValueValid(k,this.selection.start+1,i)&&!this.isValueValid(k,this.selection.start+1,i+1)){this.redTextFlash();return false}else{var a=this.dateAutocompleteCharacters[i+1];if(c==a){if(this.nextDateDelimiterExists(this.oldValue,this.selection.start,i)){k=this.oldValue;h=1}}else{if(this.isPositionAtEndOfGroup(k,this.selection.start+1,i)){if(i!=this.lastDateGroup){if(this.nextDateDelimiterExists(k,this.selection.start+1,i)){var a=this.dateAutocompleteCharacters[i+1];h=1+a.length}else{var a=this.dateAutocompleteCharacters[i+1];k=this.oldValue.substring(0,this.selection.start)+c+a+this.oldValue.substring(this.selection.start+1);h=1+a.length}}}}this.setValue(k);this.selection.moveTo(this.selection.start+h,this.selection.start+h);return false}}}return false}};Spry.Widget.ValidationTextField.prototype.onKeyDown=function(d){this.saveState();this.keyCode=d.keyCode;if(Spry.is.opera){if(this.flags.operaPasteOperation){window.clearInterval(this.flags.operaPasteOperation);this.flags.operaPasteOperation=null}if(d.ctrlKey){var c=Spry.Widget.Utils.getCharacterFromEvent(d);if(c&&"vx".indexOf(c.toLowerCase())!=-1){var a=this;this.flags.operaPasteOperation=window.setInterval(function(){a.operaPasteMonitor()},1);return true}}}if(this.keyCode!=8&&this.keyCode!=46&&Spry.Widget.Utils.isSpecialKey(d)){return true}if(this.keyCode==8||this.keyCode==46){var b=this.doValidations(this.input.value,this.input.value);if(b){return true}}if(this.useCharacterMasking&&this.pattern&&this.keyCode==46){if(d.ctrlKey){this.setValue(this.input.value.substring(0,this.selection.start))}else{if(this.selection.end==this.input.value.length||this.selection.start==this.input.value.length-1){return true}else{this.flags.operaRevertOnKeyUp=true}}if(Spry.is.mozilla&&Spry.is.mac){this.flags.skp=true}Spry.Widget.Utils.stopEvent(d);return false}if(this.useCharacterMasking&&this.pattern&&!d.ctrlKey&&this.keyCode==8){if(this.selection.start==this.input.value.length){var f=this.getAutoComplete(this.selection.start,-1);this.setValue(this.input.value.substring(0,this.input.value.length-(Spry.is.opera?0:1)-f.length));if(Spry.is.opera){this.selection.start=this.selection.start-1-f.length;this.selection.end=this.selection.end-1-f.length}}else{if(this.selection.end==this.input.value.length){return true}else{this.flags.operaRevertOnKeyUp=true}}if(Spry.is.mozilla&&Spry.is.mac){this.flags.skp=true}Spry.Widget.Utils.stopEvent(d);return false}return true};Spry.Widget.ValidationTextField.prototype.onMouseDown=function(a){if(this.flags.active){this.saveState()}};Spry.Widget.ValidationTextField.prototype.onDrop=function(a){this.flags.drop=true;this.removeHint();this.saveState();this.flags.active=true;this.addClassName(this.element,this.focusClass);this.addClassName(this.additionalError,this.focusClass)};Spry.Widget.ValidationTextField.prototype.onFocus=function(b){if(this.flags.drop){return}this.removeHint();if(this.pattern&&this.useCharacterMasking){var a=this.getAutoComplete(this.selection.start);this.setValue(this.input.value+a);this.selection.moveTo(this.input.value.length,this.input.value.length)}this.saveState();this.flags.active=true;this.addClassName(this.element,this.focusClass);this.addClassName(this.additionalError,this.focusClass)};Spry.Widget.ValidationTextField.prototype.onBlur=function(c){this.flags.active=false;this.removeClassName(this.element,this.focusClass);this.removeClassName(this.additionalError,this.focusClass);this.flags.restoreSelection=false;var b=this.doValidations(this.input.value,this.input.value);this.flags.restoreSelection=true;if(this.validateOn&Spry.Widget.ValidationTextField.ONBLUR){this.validate()}var a=this;setTimeout(function(){a.putHint()},10);return true};Spry.Widget.ValidationTextField.prototype.compilePattern=function(){if(!this.pattern){return}var f=[];var b=[];var g=[];var a=0;var h="",e="";for(var d=0;d<this.pattern.length;d++){h=this.pattern.charAt(d);if(e=="\\"){if(/[0ABXY\?]/i.test(h)){b[a-1]=h}else{b[a-1]=Spry.Widget.ValidationTextField.regExpFromChars(h)}f[a-1]=h;g[a-1]=null;e="";continue}b[a]=Spry.Widget.ValidationTextField.regExpFromChars(h);if(/[0ABXY\?]/i.test(h)){f[a]=null;g[a]=h}else{if(h=="\\"){f[a]=h;g[a]="\\"}else{f[a]=h;g[a]=null}}a++;e=h}this.autoCompleteCharacters=f;this.compiledPattern=b;this.patternCharacters=g;this.patternLength=f.length};Spry.Widget.ValidationTextField.prototype.getAutoComplete=function(h,e){if(e==-1){var g="",a="";while(h&&(g=this.getAutoComplete(--h))){a=g}return a}var b="",f="";for(var d=h;d<this.autoCompleteCharacters.length;d++){f=this.autoCompleteCharacters[d];if(f){b+=f}else{break}}return b};Spry.Widget.ValidationTextField.regExpFromChars=function(b){var a="",d="";for(var c=0;c<b.length;c++){d=b.charAt(c);switch(d){case"0":a+="\\d";break;case"A":a+="[A-Z]";break;case"a":a+="[a-z]";break;case"B":case"b":a+="[a-zA-Z]";break;case"x":a+="[0-9a-z]";break;case"X":a+="[0-9A-Z]";break;case"Y":case"y":a+="[0-9a-zA-Z]";break;case"?":a+=".";break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":a+=d;break;case"c":case"C":case"e":case"E":case"f":case"F":case"r":case"d":case"D":case"n":case"s":case"S":case"w":case"W":case"t":case"v":a+=d;break;default:a+="\\"+d}}return a};Spry.Widget.ValidationTextField.prototype.patternToRegExp=function(a){var c="^";var b=Math.min(this.compiledPattern.length,a);for(var d=0;d<b;d++){c+=this.compiledPattern[d]}c+="$";c=new RegExp(c,"");return c};Spry.Widget.ValidationTextField.prototype.resetClasses=function(){var b=[this.requiredClass,this.invalidFormatClass,this.invalidRangeMinClass,this.invalidRangeMaxClass,this.invalidCharsMinClass,this.invalidCharsMaxClass,this.validClass];for(var a=0;a<b.length;a++){this.removeClassName(this.element,b[a]);this.removeClassName(this.additionalError,b[a])}};Spry.Widget.ValidationTextField.prototype.reset=function(){this.removeHint();this.oldValue=this.input.defaultValue;this.resetClasses();if(Spry.is.ie){this.input.forceFireFirstOnPropertyChange=true;this.input.removeAttribute("forceFireFirstOnPropertyChange")}var a=this;setTimeout(function(){a.putHint()},10)};Spry.Widget.ValidationTextField.prototype.validate=function(){this.resetClasses();if(this.validateOn&Spry.Widget.ValidationTextField.ONSUBMIT){this.removeHint();this.doValidations(this.input.value,this.input.value);if(!this.flags.active){var a=this;setTimeout(function(){a.putHint()},10)}}if(this.isRequired&&this.errors&Spry.Widget.ValidationTextField.ERROR_REQUIRED){this.addClassName(this.element,this.requiredClass);this.addClassName(this.additionalError,this.requiredClass);return false}if(this.errors&Spry.Widget.ValidationTextField.ERROR_FORMAT){this.addClassName(this.element,this.invalidFormatClass);this.addClassName(this.additionalError,this.invalidFormatClass);return false}if(this.errors&Spry.Widget.ValidationTextField.ERROR_RANGE_MIN){this.addClassName(this.element,this.invalidRangeMinClass);this.addClassName(this.additionalError,this.invalidRangeMinClass);return false}if(this.errors&Spry.Widget.ValidationTextField.ERROR_RANGE_MAX){this.addClassName(this.element,this.invalidRangeMaxClass);this.addClassName(this.additionalError,this.invalidRangeMaxClass);return false}if(this.errors&Spry.Widget.ValidationTextField.ERROR_CHARS_MIN){this.addClassName(this.element,this.invalidCharsMinClass);this.addClassName(this.additionalError,this.invalidCharsMinClass);return false}if(this.errors&Spry.Widget.ValidationTextField.ERROR_CHARS_MAX){this.addClassName(this.element,this.invalidCharsMaxClass);this.addClassName(this.additionalError,this.invalidCharsMaxClass);return false}this.addClassName(this.element,this.validClass);this.addClassName(this.additionalError,this.validClass);return true};Spry.Widget.ValidationTextField.prototype.addClassName=function(b,a){if(!b||!a||(b.className&&b.className.search(new RegExp("\\b"+a+"\\b"))!=-1)){return}b.className+=(b.className?" ":"")+a};Spry.Widget.ValidationTextField.prototype.removeClassName=function(b,a){if(!b||!a||(b.className&&b.className.search(new RegExp("\\b"+a+"\\b"))==-1)){return}b.className=b.className.replace(new RegExp("\\s*\\b"+a+"\\b","g"),"")};Spry.Widget.ValidationTextField.prototype.showError=function(a){alert("Spry.Widget.TextField ERR: "+a)};Spry.Widget.SelectionDescriptor=function(a){this.element=a;this.update()};Spry.Widget.SelectionDescriptor.prototype.update=function(){if(Spry.is.ie&&Spry.is.windows){var a=this.element.ownerDocument.selection;if(this.element.nodeName=="TEXTAREA"){if(a.type!="None"){try{var f=a.createRange()}catch(b){return}if(f.parentElement()==this.element){var c=this.element.ownerDocument.body.createTextRange();c.moveToElementText(this.element);for(var g=0;c.compareEndPoints("StartToStart",f)<0;g++){c.moveStart("character",1)}this.start=g;c=this.element.ownerDocument.body.createTextRange();c.moveToElementText(this.element);for(var d=0;c.compareEndPoints("StartToEnd",f)<0;d++){c.moveStart("character",1)}this.end=d;this.length=this.end-this.start;this.text=f.text}}}else{if(this.element.nodeName=="INPUT"){try{this.range=a.createRange()}catch(b){return}this.length=this.range.text.length;var h=this.range.duplicate();this.start=-h.moveStart("character",-10000);h=this.range.duplicate();h.collapse(false);this.end=-h.moveStart("character",-10000);this.text=this.range.text}}}else{var e=this.element;var i=0;var j=0;try{i=e.selectionStart}catch(b){}try{j=e.selectionEnd}catch(b){}if(Spry.is.safari){if(i==2147483647){i=0}if(j==2147483647){j=0}}this.start=i;this.end=j;this.length=j-i;this.text=this.element.value.substring(i,j)}};Spry.Widget.SelectionDescriptor.prototype.destroy=function(){try{delete this.range}catch(a){}try{delete this.element}catch(a){}};Spry.Widget.SelectionDescriptor.prototype.move=function(a){if(Spry.is.ie&&Spry.is.windows){this.range.move("character",a);this.range.select()}else{try{this.element.selectionStart++}catch(b){}}this.update()};Spry.Widget.SelectionDescriptor.prototype.moveTo=function(f,a){if(Spry.is.ie&&Spry.is.windows){if(this.element.nodeName=="TEXTAREA"){var e=this.element.createTextRange();this.range=this.element.createTextRange();this.range.move("character",f);this.range.moveEnd("character",a-f);var c=this.range.compareEndPoints("StartToStart",e);if(c<0){this.range.setEndPoint("StartToStart",e)}var b=this.range.compareEndPoints("EndToEnd",e);if(b>0){this.range.setEndPoint("EndToEnd",e)}}else{if(this.element.nodeName=="INPUT"){this.range=this.element.ownerDocument.selection.createRange();this.range.move("character",-10000);this.start=this.range.moveStart("character",f);this.end=this.start+this.range.moveEnd("character",a-f)}}this.range.select()}else{this.start=f;try{this.element.selectionStart=f}catch(d){}this.end=a;try{this.element.selectionEnd=a}catch(d){}}this.ignore=true;this.update()};Spry.Widget.SelectionDescriptor.prototype.moveEnd=function(a){if(Spry.is.ie&&Spry.is.windows){this.range.moveEnd("character",a);this.range.select()}else{try{this.element.selectionEnd++}catch(b){}}this.update()};Spry.Widget.SelectionDescriptor.prototype.collapse=function(a){if(Spry.is.ie&&Spry.is.windows){this.range=this.element.ownerDocument.selection.createRange();this.range.collapse(a);this.range.select()}else{if(a){try{this.element.selectionEnd=this.element.selectionStart}catch(b){}}else{try{this.element.selectionStart=this.element.selectionEnd}catch(b){}}}this.update()};if(!Spry.Widget.Form){Spry.Widget.Form={}}if(!Spry.Widget.Form.onSubmitWidgetQueue){Spry.Widget.Form.onSubmitWidgetQueue=[]}if(!Spry.Widget.Form.validate){Spry.Widget.Form.validate=function(f){var e=true;var d=true;var c=Spry.Widget.Form.onSubmitWidgetQueue;var a=c.length;for(var b=0;b<a;b++){if(!c[b].isDisabled()&&c[b].form==f){d=c[b].validate();e=d&&e}}return e}}if(!Spry.Widget.Form.onSubmit){Spry.Widget.Form.onSubmit=function(b,a){if(Spry.Widget.Form.validate(a)==false){return false}return true}}if(!Spry.Widget.Form.onReset){Spry.Widget.Form.onReset=function(d,f){var c=Spry.Widget.Form.onSubmitWidgetQueue;var a=c.length;for(var b=0;b<a;b++){if(!c[b].isDisabled()&&c[b].form==f&&typeof(c[b].reset)=="function"){c[b].reset()}}return true}}if(!Spry.Widget.Form.destroy){Spry.Widget.Form.destroy=function(b){var c=Spry.Widget.Form.onSubmitWidgetQueue;for(var a=0;a<Spry.Widget.Form.onSubmitWidgetQueue.length;a++){if(c[a].form==b&&typeof(c[a].destroy)=="function"){c[a].destroy();a--}}}}if(!Spry.Widget.Form.destroyAll){Spry.Widget.Form.destroyAll=function(){var b=Spry.Widget.Form.onSubmitWidgetQueue;for(var a=0;a<Spry.Widget.Form.onSubmitWidgetQueue.length;a++){if(typeof(b[a].destroy)=="function"){b[a].destroy();a--}}}}if(!Spry.Widget.Utils){Spry.Widget.Utils={}}Spry.Widget.Utils.punycode_constants={base:36,tmin:1,tmax:26,skew:38,damp:700,initial_bias:72,initial_n:128,delimiter:45,maxint:2<<26-1};Spry.Widget.Utils.punycode_encode_digit=function(a){return String.fromCharCode(a+22+75*(a<26))};Spry.Widget.Utils.punycode_adapt=function(d,c,b){d=b?d/this.punycode_constants.damp:d>>1;d+=d/c;for(var a=0;d>((this.punycode_constants.base-this.punycode_constants.tmin)*this.punycode_constants.tmax)/2;a+=this.punycode_constants.base){d/=this.punycode_constants.base-this.punycode_constants.tmin}return a+(this.punycode_constants.base-this.punycode_constants.tmin+1)*d/(d+this.punycode_constants.skew)};Spry.Widget.Utils.punycode_encode=function(w,c){var e=w.split("");w=[];for(var r=0;r<e.length;r++){w.push(e[r].charCodeAt(0))}var f="";var s,v,p,g,a,l,z;var y=w.length;var d=this.punycode_constants.initial_n;var x=0;var u=this.punycode_constants.initial_bias;var o=0;for(p=0;p<y;p++){if(w[p]<128){if(c-o<2){return false}f+=String.fromCharCode(w[p]);o++}}s=v=o;if(v>0){f+=String.fromCharCode(this.punycode_constants.delimiter);o++}while(s<y){for(g=this.punycode_constants.maxint,p=0;p<y;p++){if(w[p]>=d&&w[p]<g){g=w[p]}}if(g-d>(this.punycode_constants.maxint-x)/(s+1)){return false}x+=(g-d)*(s+1);d=g;for(p=0;p<y;p++){if(w[p]<d){if(++x==0){return false}}if(w[p]==d){for(a=x,l=this.punycode_constants.base;true;l+=this.punycode_constants.base){if(o>=c){return false}z=l<=u?this.punycode_constants.tmin:l>=u+this.punycode_constants.tmax?this.punycode_constants.tmax:l-u;if(a<z){break}f+=this.punycode_encode_digit(z+(a-z)%(this.punycode_constants.base-z));o++;a=(a-z)/(this.punycode_constants.base-z)}f+=this.punycode_encode_digit(a);o++;u=this.punycode_adapt(x,s+1,s==v);x=0;s++}}x++,d++}return f};Spry.Widget.Utils.setOptions=function(d,c,a){if(!c){return}for(var b in c){if(a&&c[b]==undefined){continue}d[b]=c[b]}};Spry.Widget.Utils.firstValid=function(){var a=null;for(var b=0;b<Spry.Widget.Utils.firstValid.arguments.length;b++){if(typeof(Spry.Widget.Utils.firstValid.arguments[b])!="undefined"){a=Spry.Widget.Utils.firstValid.arguments[b];break}}return a};Spry.Widget.Utils.specialCharacters=",8,9,16,17,18,20,27,33,34,35,36,37,38,40,45,144,192,63232,";Spry.Widget.Utils.specialSafariNavKeys="63232,63233,63234,63235,63272,63273,63275,63276,63277,63289,";Spry.Widget.Utils.specialNotSafariCharacters="39,46,91,92,93,";Spry.Widget.Utils.specialCharacters+=Spry.Widget.Utils.specialSafariNavKeys;if(!Spry.is.safari){Spry.Widget.Utils.specialCharacters+=Spry.Widget.Utils.specialNotSafariCharacters}Spry.Widget.Utils.isSpecialKey=function(a){return Spry.Widget.Utils.specialCharacters.indexOf(","+a.keyCode+",")!=-1};Spry.Widget.Utils.getCharacterFromEvent=function(d){var a=d.type=="keydown";var b=null;var c=null;if(Spry.is.mozilla&&!a){if(d.charCode){c=String.fromCharCode(d.charCode)}else{b=d.keyCode}}else{b=d.keyCode||d.which;if(b!=13){c=String.fromCharCode(b)}}if(Spry.is.safari){if(a){b=d.keyCode||d.which;c=String.fromCharCode(b)}else{b=d.keyCode||d.which;if(Spry.Widget.Utils.specialCharacters.indexOf(","+b+",")!=-1){c=null}else{c=String.fromCharCode(b)}}}if(Spry.is.opera){if(Spry.Widget.Utils.specialCharacters.indexOf(","+b+",")!=-1){c=null}else{c=String.fromCharCode(b)}}return c};Spry.Widget.Utils.getFirstChildWithNodeNameAtAnyLevel=function(a,c){var b=a.getElementsByTagName(c);if(b){return b[0]}return null};Spry.Widget.Utils.getFirstParentWithNodeName=function(a,b){while(a.parentNode&&a.parentNode.nodeName.toLowerCase()!=b.toLowerCase()&&a.parentNode.nodeName!="BODY"){a=a.parentNode}if(a.parentNode&&a.parentNode.nodeName.toLowerCase()==b.toLowerCase()){return a.parentNode}else{return null}};Spry.Widget.Utils.destroyWidgets=function(a){if(typeof a=="string"){a=document.getElementById(a)}var c=Spry.Widget.Form.onSubmitWidgetQueue;for(var b=0;b<Spry.Widget.Form.onSubmitWidgetQueue.length;b++){if(typeof(c[b].destroy)=="function"&&Spry.Widget.Utils.contains(a,c[b].element)){c[b].destroy();b--}}};Spry.Widget.Utils.contains=function(b,c){if(typeof b.contains=="object"){return c&&b&&(b==c||b.contains(c))}else{var a=c;while(a){if(a==b){return true}a=a.parentNode}return false}};Spry.Widget.Utils.addEventListener=function(c,b,d,a){try{if(c.addEventListener){c.addEventListener(b,d,a)}else{if(c.attachEvent){c.attachEvent("on"+b,d,a)}}}catch(f){}};Spry.Widget.Utils.removeEventListener=function(c,b,d,a){try{if(c.removeEventListener){c.removeEventListener(b,d,a)}else{if(c.detachEvent){c.detachEvent("on"+b,d,a)}}}catch(f){}};Spry.Widget.Utils.stopEvent=function(a){try{this.stopPropagation(a);this.preventDefault(a)}catch(b){}};Spry.Widget.Utils.stopPropagation=function(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}};Spry.Widget.Utils.preventDefault=function(a){if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};